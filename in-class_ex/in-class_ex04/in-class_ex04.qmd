---
title: "In-Class Exercise 4: 2nd Order Spatial Point Patterns Analysis"
date: "30 January 2023"
date-modified: "`r Sys.Date()`"
number-sections: true
format: html
execute: 
  echo: true
  eval: true
  warning: false
editor: visual
---

## Overview

Spatial point processes of childcare centers in Singapore using 2nd order spatial point pattern analysis methods.

```{r}
pacman::p_load(maptools, sf, raster, spatstat, tmap)
```

Importing spatial data - use `sf`package

```{r}
childcare_sf <- st_read("data/child-care-services-geojson.geojson") %>%
  st_transform(crs = 3414)

sg_sf <- st_read(dsn = "data", layer="CostalOutline")

mpsz_sf <- st_read(dsn = "data", 
                layer = "MP14_SUBZONE_WEB_PL")
```

Plotting the map of childcare centers:

```{r}
tmap_mode("view")
tm_shape(childcare_sf)+
  tm_dots(alph=0.5, # transparency (intensity of colour based on value)
          size=0.01)+
  tm_view(set.zoom.limits=c(11,24)) # zoom-out value, zoom-in value
```

Converting `sf` dataframe into `SpatialPointsDataFrame`.

```{r}
# because we want to use spatstat
childcare <- as_Spatial(childcare_sf)
mpsz <- as_Spatial(mpsz_sf)
sg <- as_Spatial(sg_sf)
```

Converting `SpatialPointsDataFrame` into Formal Class `SpatialPoints`

```{r}
childcare_sp <- as(childcare, "SpatialPoints")
sg_sp <- as(sg, "SpatialPolygons")
```

Converting them into **ppp** format to be understood by `spatstat`

```{r}
childcare_ppp = as(childcare_sp, "ppp")
```
